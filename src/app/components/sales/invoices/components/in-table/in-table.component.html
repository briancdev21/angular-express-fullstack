<div class="content price-table">
  <TABLE>
    <thead>
      <tr>
        <th></th>
        <th>Service Date</th>
        <th>SKU</th>
        <th>MODEL</th>
        <th>Name</th>
        <th>QUANTITY</th>
        <th>UNIT PRICE</th>
        <th>DISCOUNT %</th>
        <th>TOTAL</th>
        <th>TAX RATE</th>
      </tr>
    </thead>
    <tbody class="ngx-dnd-container" ngxDroppable>

      <tr *ngFor="let productDetailInfo of productDetails; index as i" class="ngx-dnd-item has-handle" ngxDraggable>
        
        <td class="handle-bar">
          <span ngxDragHandle class="handlebar">:</span>
        </td>
        <td class="service-date">
          <div class="created-input" >
            <input [owlDateTimeTrigger]="serviceDate" [owlDateTime]="serviceDate" (dateTimeChange)="selectCreatedFrom($event)" [(ngModel)]="productDetailInfo.serviceDate" [min]="yesterday" placeholder="Enter date here">
            <owl-date-time [pickerType]="'calendar'" #serviceDate ></owl-date-time>
          </div>
        </td>
        <td class="sku">
          <div class="flex">
            <img class="remove-btn" [ngClass]="{'hide': i == 0 && productDetails.length == 1 }" src="/assets/images/Trash Symbol.svg" (click)="removeProduct(i)"
            />
            <ng2-completer (keyup)="keyListener($event, i)" [dataService]="skuService" placeholder="Type SKU here..." [minSearchLength]="0" (selected)="onSkuSelected($event, i)" [(ngModel)]="productDetailInfo.sku" ></ng2-completer>
          </div>
        </td>
        <td class="model">
          <ng2-completer (keyup)="keyListener($event, i)" [dataService]="modelService" placeholder="Type Model here..." [minSearchLength]="0" (selected)="onModelSelected($event, i)" [(ngModel)]="productDetailInfo.model" ></ng2-completer>
        </td>
        <td class="name">
            <ng2-completer (keyup)="keyListener($event, i)" [dataService]="nameService" placeholder="Type NAME here..." [minSearchLength]="0" (selected)="onNameSelected($event, i)" [(ngModel)]="productDetailInfo.name" ></ng2-completer>
        </td>
        <td class="quantity">
          <input class="quantity" type="number" placeholder="0" min="0" [(ngModel)]="productDetailInfo.quantity" (ngModelChange)="calcualteTotalPrice(i)" />
        </td>
        <td class="unitprice">
          <div class="dollar">
            <input *ngIf="unitpriceEditable" (blur)="unitpriceEditable = false;" type="number" class="unitprice" step="0.01" min="0.00" placeholder="0.00" [(ngModel)]="productDetailInfo.unitprice" (input)="checkValue($event)" (ngModelChange)="calcualteTotalPrice(i)" />
            <div class="value-display" *ngIf="!unitpriceEditable" placeholder="0.00" (click)="unitpriceEditable = true;" >{{productDetailInfo.unitprice | number:'1.2-2' }}</div>
          </div>
        </td>
        <td class="discount">
          <input class="discount" type="number" placeholder="0" min="0" [(ngModel)]="productDetailInfo.discount"  (input)="checkDiscount($event)"  (ngModelChange)="calcualteTotalPrice(i)"/>
        </td>
        <td class="total">
          <div class="dollar">
            <input type="number" class="total" step="0.01" min="0.00" placeholder="0.00" [(ngModel)]="productDetailInfo.total" readonly (ngModelChange)="calcualteTotalPrice(i)" *ngIf="priceTotalEditable" (blur)="priceTotalEditable = false;"/>
            <div class="value-display" *ngIf="!priceTotalEditable" placeholder="0.00" (click)="priceTotalEditable = true;" >{{productDetailInfo.total | number:'1.2-2' }}</div>
          </div>
        </td>
        <td class="taxrate">
          <div class="editable-select" >
            <input type="text" placeholder="Tax Rate" [(ngModel)]="productDetailInfo.taxrate"  (ngModelChange)="calcualteTotalPrice(i)" />
            <select [(ngModel)]="productDetailInfo.taxrate" (ngModelChange)="calcualteTotalPrice(i)" >
                <option value="GST" >GST</option>
                <option value="PST" >PST</option>
            </select>
          </div>
        </td>
      </tr>
    </tbody>
  </TABLE>
</div>